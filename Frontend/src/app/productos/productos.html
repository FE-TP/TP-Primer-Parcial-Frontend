<div class="productos-container">
  <!-- Mensajes de notificaciÃ³n -->
  <div *ngIf="mensaje" class="alert" [ngClass]="{'alert-success': tipoMensaje === 'success', 'alert-danger': tipoMensaje === 'error'}">
    <span class="icon-info" *ngIf="tipoMensaje === 'success'">âœ…</span>
    <span class="icon-danger" *ngIf="tipoMensaje === 'error'">âŒ</span>
    {{ mensaje }}
  </div>

  <!-- Header -->
  <div class="header-container">
    <h1 class="page-title">AdministraciÃ³n de Productos</h1>
    <button class="btn btn-primary" (click)="nuevoProducto()">
      <span>â•</span>
      Nuevo Producto
    </button>
  </div>

  <div class="table-container">
    <!-- Filtro -->
    <input
      type="text"
      class="form-control mb-3"
      placeholder="ğŸ” Buscar producto por nombre..."
      [(ngModel)]="filtro"
    />

    <!-- Estado vacÃ­o -->
    <div *ngIf="productosFiltrados.length === 0 && filtro === ''" class="empty-state">
      <div class="empty-state-icon">ğŸ“¦</div>
      <div class="empty-state-text">No hay productos registrados</div>
      <button class="btn btn-primary" (click)="nuevoProducto()">
        <span>â•</span>
        Crear primer producto
      </button>
    </div>

    <!-- No hay resultados de bÃºsqueda -->
    <div *ngIf="productosFiltrados.length === 0 && filtro !== ''" class="empty-state">
      <div class="empty-state-icon">ğŸ”</div>
      <div class="empty-state-text">No se encontraron productos que coincidan con "{{ filtro }}"</div>
      <button class="btn btn-secondary" (click)="limpiarFiltro()">
        Limpiar bÃºsqueda
      </button>
    </div>

    <!-- Tabla -->
    <table class="table" *ngIf="productosFiltrados.length > 0">
      <thead>
        <tr>
          <th>ID</th>
          <th>Nombre del Producto</th>
          <th class="text-center">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of productosFiltrados; trackBy: trackByProductoId">
          <td>
            <span style="font-family: monospace; font-weight: 600; color: var(--gray-600);">
              #{{ p.idProducto }}
            </span>
          </td>
          <td>
            <span style="font-weight: 500;">{{ p.nombre }}</span>
          </td>
          <td class="text-center">
            <button 
              class="btn btn-warning me-2" 
              (click)="editarProducto(p)"
              title="Editar producto">
              <span class="icon-warning">âœï¸</span>
              Editar
            </button>
            <button 
              class="btn btn-danger" 
              (click)="confirmarEliminacion(p)"
              title="Eliminar producto">
              <span class="icon-danger">ğŸ—‘ï¸</span>
              Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal de Producto -->
  <div class="modal-overlay" *ngIf="mostrarModal">
    <div class="modal-content">
      <h2>
        <span *ngIf="!modoEdicion" class="icon-success">â•</span>
        <span *ngIf="modoEdicion" class="icon-warning">âœï¸</span>
        {{ modoEdicion ? 'Editar Producto' : 'Nuevo Producto' }}
      </h2>

      <div style="margin-bottom: 1.5rem;">
        <label style="display: block; margin-bottom: 0.5rem; font-weight: 600; color: var(--gray-700);">
          Nombre del producto *
        </label>
        <input
          #nombreInput
          type="text"
          class="form-control"
          placeholder="Ingrese el nombre del producto"
          [(ngModel)]="nombre"
          (keyup.enter)="guardarProducto()"
          [style.border-color]="nombreError ? 'var(--danger-color)' : ''"
        />
        <small *ngIf="nombreError" style="color: var(--danger-color); margin-top: 0.25rem; display: block;">
          {{ nombreError }}
        </small>
      </div>

      <div class="d-flex justify-content-end" style="gap: 1rem;">
        <button class="btn btn-secondary" (click)="cerrarModal()">
          <span>âŒ</span>
          Cancelar
        </button>
        <button 
          class="btn btn-success" 
          (click)="guardarProducto()"
          [disabled]="!nombre.trim()">
          <span class="icon-success">ğŸ’¾</span>
          {{ modoEdicion ? 'Actualizar' : 'Guardar' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Modal de ConfirmaciÃ³n de EliminaciÃ³n -->
  <div class="modal-overlay confirmation-modal" *ngIf="mostrarModalConfirmacion">
    <div class="modal-content">
      <div class="modal-icon icon-danger">ğŸ—‘ï¸</div>
      <h3 class="modal-title">Â¿Confirmar eliminaciÃ³n?</h3>
      <p class="modal-message">
        Â¿EstÃ¡s seguro de que deseas eliminar el producto 
        <strong>"{{ productoAEliminar?.nombre }}"</strong>?
        <br><br>
        Esta acciÃ³n no se puede deshacer.
      </p>
      
      <div class="modal-actions">
        <button class="btn btn-secondary" (click)="cancelarEliminacion()">
          <span>âŒ</span>
          Cancelar
        </button>
        <button class="btn btn-danger" (click)="confirmarEliminacionDefinitiva()">
          <span class="icon-danger">ğŸ—‘ï¸</span>
          SÃ­, eliminar
        </button>
      </div>
    </div>
  </div>
</div>